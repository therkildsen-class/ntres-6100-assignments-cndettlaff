---
title: "Assignment 5"
format: gfm
editor: visual
---

```{r}
library(tidyverse)
library(knitr)
library(gapminder)
```

# Exercise 1. Trends in land value

```{r}
housing <- read_csv("https://raw.githubusercontent.com/nt246/NTRES-6100-data-science/master/datasets/landdata_states.csv")
housing %>%
  head() %>% 
  kable() 
```

#### 1.1 Washington DC was not assigned to a region in this dataset. According to the United States Census Bureau, however, DC is part of the South region. Here:

```{r}
DC_housing <- housing |> 
 filter(State == "DC") |> 
  mutate(region = "South") |> 
  select(region, State, Land.Value, Date)

head(DC_housing) |> 
  kable()
```

A\) There are 153 records

#### 1.2 Generate a tibble/dataframe that summarizes the mean land value of each region at each time point and show its first 6 lines.

```{r}
housing |> 
  group_by(region, Date) |> 
  summarise(mean_land_value = mean(Land.Value, na.rm = TRUE)) |> 
  arrange(region, Date) |> 
  head() |> 
  kable()
```

#### 1.3 Using the tibble/dataframe from 1.2, plot the trend in mean land value of each region through time.

```{r}
#| warning: false
housing |> 
  group_by(region, Date) |> 
  summarise(mean_land_value = mean(Land.Value, na.rm = TRUE)) |> 
  arrange(region, Date) |> 
  filter(region == c("Midwest", "N. East", "West", "South")) |> 
  ggplot(aes(x = Date, y = mean_land_value, color = region)) +
  geom_line(linewidth = 1) +
  labs(
    title = "Mean Land Value by Region Over Time",
    x = "Year",
    y = "Mean Land Value (USD)",
    color = "Region"
  ) +
  theme_minimal(base_size = 13) +
  theme(legend.position = "right")
```
